{% extends 'base.html' %}
{% load static %}

{% block title %}{{ titulo_pagina }}{% endblock %}

{% block content %}

<div class="blog-header">
    <h1>Blog Artaud ‚úçÔ∏è</h1>
    <p>Noticias, reviews y el rinc√≥n del coleccionista. Descubr√≠ lo √∫ltimo del mundo anal√≥gico.</p>
    
    {% if user.is_authenticated %}
        <a href="{% url 'blog_crear' %}" class="btn-blog-create">Escribir un Art√≠culo +</a>
    {% endif %}
</div>

<div class="blog-container">

    <div class="blog-main">
        {% if articulos %}
            {% for articulo in articulos %}
                <article class="blog-card">
                    <div class="blog-card-header">
                        <span class="blog-category tag-{{ articulo.categoria }}">{{ articulo.get_categoria_display }}</span>
                        <span class="blog-date">{{ articulo.fecha_publicacion|date:"d M Y" }}</span>
                    </div>
                    
                    <a href="{% url 'blog_detalle' pk=articulo.pk %}" class="blog-title-link">
                        <h2>{{ articulo.titulo }}</h2>
                    </a>
                    
                    <p class="blog-author">
                        Por 
                        <a href="{% url 'ver_vendedor' username=articulo.autor.username %}" 
                        style="color: inherit; font-weight: bold; text-decoration: underline;">
                        {{ articulo.autor.username }}
                        </a>
                    </p>
                    
                    <p class="blog-preview">
                        {{ articulo.cuerpo|truncatewords:50 }} </p>
                    
                    <a href="{% url 'blog_detalle' pk=articulo.pk %}" class="read-more">Leer m√°s ‚Üí</a>
                </article>
            {% endfor %}
        {% else %}
            <p class="no-articles">No hay art√≠culos publicados en esta categor√≠a.</p>
            <a href="{% url 'blog_lista' %}" style="color: var(--color-acento);">Ver todo</a>
        {% endif %}
    </div>

    <aside class="blog-sidebar">
        <div class="sidebar-widget">
            <h3>Categor√≠as</h3>
            <ul>
                <li>
                    <a href="{% url 'blog_lista' %}" class="{% if not categoria_actual %}active{% endif %}">
                        Todas
                    </a>
                </li>
                {% for key, label in categorias %}
                    <li>
                        <a href="?categoria={{ key }}" class="{% if categoria_actual == key %}active{% endif %}">
                            {{ label }}
                        </a>
                    </li>
                {% endfor %}
            </ul>
        </div>

        <div class="sidebar-widget">
            <h3>Buscar en el Blog</h3>
            <form action="." method="GET" class="blog-search-form">
                <input type="text" name="q" placeholder="Buscar..." value="{{ query_actual|default:'' }}">
                <button type="submit">üîç</button>
            </form>
        </div>
    </aside>

</div>

{% endblock content %}